{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "2dc82ed0_0edc0a72",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1012974
      },
      "writtenOn": "2021-01-22T15:13:14Z",
      "side": 1,
      "message": "Thanks! I\u0027ve uploaded https://skia-review.googlesource.com/c/skia/+/357277 in Skia so the generator will continue to include this.",
      "revId": "b6fd6404e45bbe48c26c9857efea8055fed856bb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "972f6736_98860793",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1359095
      },
      "writtenOn": "2021-01-22T16:39:43Z",
      "side": 1,
      "message": "Did you get an email for my reply by email? If not, please see it here on the review thread.",
      "parentUuid": "2dc82ed0_0edc0a72",
      "revId": "b6fd6404e45bbe48c26c9857efea8055fed856bb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec28f8ca_ab9448c2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1012974
      },
      "writtenOn": "2021-01-25T16:51:46Z",
      "side": 1,
      "message": "Thanks! You might still need this (or some version of it), because my plan is to make a change to upstream Skia, which will get merged into the internal Android version of external/skia. That won\u0027t affect AOSP until we open source S, whenever that is. I also have some questions in line:\n\n\u003e Patch Set 1:\n\u003e \n\u003e In answer to the question on that review thread, third_party/libgifcodec/ has a GPL license. You are welcome to split out the single license that the large-scale-change adds into multiple licenses. For example, applying GPL only to the targets built from third_party/libgifcodec/\n\nCurrently, that code is built as part of libskia. If we wanted to separate that out, would that mean we\u0027d need to build a separate library that libskia imports as a shared library?\n\n\u003e \n\u003e Any module or rule type where you might want to override the default_applicable_licenses allows a \u0027licenses \u003d [...],\u0027 property.\n\nI\u0027m not familiar with where the \u0027licenses\u0027 property is allowed. You currently have a default_applicable_licenses property for the whole package. If I wanted to split things up, could it look something like:\n\ncat \u003e Android.bp\n\npackage {\n    default_applicable_licenses: [\"external_skia_license\"],\n}\n\nlicense {\n    name: \"external_skia_license\",\n    visibility: [\":__subpackages__\"],\n    license_kinds: \u003csame as before, minus GPL\u003e\n    license_text: [\"LICENSE\",\"NOTICE\"],\n}\n\ncc_library {\n  name: \"libgifcodec\",\n  licenses: \u003cGPL licenses\u003e # override/replace the default\n  ...\n}\n\ncc_library_static {\n  name: \"libskia\", # mostly as before\n  ...\n  shared_libs: [\n    ...\n    \"libgifcodec\",\n  ]\n  ...\n}",
      "revId": "b6fd6404e45bbe48c26c9857efea8055fed856bb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4fd487fb_813a562f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1359095
      },
      "writtenOn": "2021-01-25T17:33:44Z",
      "side": 1,
      "message": "\u003e would that mean we\u0027d need to build a separate library that libskia imports as a shared library?\n\n\nYou need a target to attach it to. It doesn\u0027t necessarily have to be a shared library; although, shared libraries vs. static libraries affect source-sharing requirements.\n\nIn the case of unused contrib/ stuff, I recommend a filegroup.\n\n\n\n\u003e If I wanted to split things up, could it look something like:\n\nYou need a 2nd license module:\n\n\ncat \u003e Android.bp\n\npackage {\n\n    default_applicable_licenses: [\"external_skia_license\"],\n}\nlicense {\n\n    name: \"external_skia_license\",\n    visibility: [\":__subpackages__\"],\n    license_kinds: \u003csame as before, minus GPL\u003e\n    license_text: [\"LICENSE\",\"NOTICE\"],\n}\nlicense {\n\n    name: \"external_skia_gifcodec_license\",\n    visibility: [\":__subpackages__\"],\n    license_kinds: \u003call the kinds that apply including GPL\u003e\n    license_text: \u003cpaths to relevant license or notice files\u003e,\n}\ncc_library {\n\n  name: \"libgifcodec\",\n  licenses: [\"external_skia_gpl_license\"],\n  ...\n}\ncc_library_static {\n\n  name: \"libskia\", # mostly as before\n  ...\n  shared_libs: [\n    ...\n    \"libgifcodec\",\n  ]\n  ...\n}\n\n\nFeel free to rename the license modules. They are Soong module names so the usual rules apply. They have to be globally unique (in the soong_namespace if you are using namespaces). The large-scale-change derives the names it uses from the path because it can -- not because that\u0027s the best choice.\n\nAlso, feel free to change the visibility. The large-scale-change added __subpackages__ at the last minute because 1 or 2 projects added //visibility:private that had sub-projects without their own LICENSE or NOTICE file. __subpackages__ is the minimal visibility that guarantees the large-scale-change will work. It\u0027s not a recommendation or best practice or anything.\n\nI changed the large-scale-change scripts to put 1 license_kind and 1 license_text per line, and added a few licenses to the scanner, so you might want to wait until you see the new change before updating your scripts.\n\nAlternatively, you could just attach the license to the existing target:\n\ncat \u003e Android.bp\n\npackage {\n\n    default_applicable_licenses: [\"external_skia_license\"],\n}\nlicense {\n\n    name: \"external_skia_license\",\n    visibility: [\":__subpackages__\"],\n    license_kinds: \u003csame as before, minus GPL\u003e\n    license_text: [\"LICENSE\",\"NOTICE\"],\n}\nlicense {\n\n    name: \"external_skia_gifcodec_license\",\n    visibility: [\":__subpackages__\"],\n    license_kinds: \u003call the kinds that apply including GPL\u003e\n    license_text: \u003cpaths to relevant license or notice files\u003e,\n}\ncc_library_static {\n\n  name: \"libskia\", # mostly as before\n  ...\n  licenses: [\n    \"external_skia_license\",\n    \"external_skia_gpl_license\",\n  ],\n  ...\n}\n\n\nBut overall, I think I like the added target better. Otherwise, you have to stop and think about which licenses apply for every new target you add instead of just letting the build system calculate it for you.",
      "parentUuid": "ec28f8ca_ab9448c2",
      "revId": "b6fd6404e45bbe48c26c9857efea8055fed856bb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}